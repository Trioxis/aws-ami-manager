{"version":3,"sources":["../index.js"],"names":["ec2","instances","listEC2","then","listAMIs","data","burnt_images_info","countAMIs","tagged_instance","map","parseInt","instance_info","counter","console","log","details","name","params","InstanceId","id","Name","name_date","createImage","err","yes_or_no","burn_or_not","registerAMI","deregisterAMI","catch","error"],"mappings":";;AAAA;;;;;;AAGE,IAAIA,MAAM,uBAAV;;AAEA,IAAIC,YAAYD,IAAIE,OAAJ,GAAcC,IAAd,CAAmB,2BAAmB;AACpDH,MAAII,QAAJ,GAAeD,IAAf,CAAoB,UAASE,IAAT,EAAc;AAChC;AACA,QAAIC,oBAAoBN,IAAIO,SAAJ,CAAcF,IAAd,EAAoBG,eAApB,CAAxB;AACA;AACAF,sBAAkBG,GAAlB,CAAsB,yBAAiB;AACrC,UAAGC,SAASC,cAAcC,OAAvB,KAAmC,CAAtC,EAAwC;AACtCC,gBAAQC,GAAR,CAAY,kCAAkCH,cAAcI,OAAd,CAAsBC,IAApE;AACA,YAAIC,SAAS;AACXC,sBAAaP,cAAcI,OAAd,CAAsBI,EADxB;AAEXC,gBAAOT,cAAcI,OAAd,CAAsBM;AAFlB,SAAb;AAIArB,YAAIsB,WAAJ,CAAgBL,MAAhB,EAAwB,UAASM,GAAT,EAAclB,IAAd,EAAoB;AACxCQ,kBAAQC,GAAR,CAAYT,IAAZ,EADwC,CACX;AAChC,SAFD;AAGD,OATD,MASK;AACHQ,gBAAQC,GAAR,CAAY,2CAAZ;AACAD,gBAAQC,GAAR,CAAYH,cAAcC,OAAd,GAAwB,sBAAxB,GAAiDD,cAAcI,OAAd,CAAsBC,IAAnF;AACA,YAAIQ,YAAYxB,IAAIyB,WAAJ,CAAgBd,aAAhB,CAAhB;AACAE,gBAAQC,GAAR,CAAYU,SAAZ;AACA,YAAGA,SAAH,EAAa;AACXX,kBAAQC,GAAR,CAAY,MAAZ;AACAd,cAAI0B,WAAJ,CAAgBf,aAAhB;AACD,SAHD,MAGK;AACHE,kBAAQC,GAAR,CAAY,YAAZ;AACAd,cAAI2B,aAAJ,CAAkBhB,aAAlB;AACD;AACF;AACF,KAvBD;AAyBD,GA7BD;AA8BD,CA/Be,EA+BbiB,KA/Ba,CA+BP,UAASC,KAAT,EAAe;AACtBhB,UAAQC,GAAR,CAAYe,KAAZ;AACD,CAjCe,CAAhB","file":"index.js","sourcesContent":["import AMI from './burnAMI';\n\n\n  var ec2 = new AMI();\n\n  var instances = ec2.listEC2().then(tagged_instance => {\n    ec2.listAMIs().then(function(data){\n      // console.log(data);\n      var burnt_images_info = ec2.countAMIs(data, tagged_instance);\n      // console.log(burnt_images_info);\n      burnt_images_info.map(instance_info => {\n        if(parseInt(instance_info.counter) == 0){\n          console.log(\"---- First time to burn ---- \" + instance_info.details.name);\n          var params = {\n            InstanceId : instance_info.details.id,\n            Name : instance_info.details.name_date\n          }\n          ec2.createImage(params, function(err, data) {\n              console.log(data);           // successful response\n          });\n        }else{\n          console.log(\"-----------------------------------------\");\n          console.log(instance_info.counter + \" AMIs exisiting for \" + instance_info.details.name);\n          let yes_or_no = ec2.burn_or_not(instance_info);\n          console.log(yes_or_no);\n          if(yes_or_no){\n            console.log(\"burn\");\n            ec2.registerAMI(instance_info);\n          }else{\n            console.log(\"deregister\");\n            ec2.deregisterAMI(instance_info);\n          }\n        }\n      })\n\n    });\n  }).catch(function(error){\n    console.log(error);\n  });\n"]}